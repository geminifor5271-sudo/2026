<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>F1 Shanghai 2026</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff1e00">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        :root {
            --primary: #ff1e00;
            --bg: #050505;
            --card: #151515;
            --text: #ffffff;
            --text-s: #888888;
            --accent: #00d2ff;
        }

        /* æ ¸å¿ƒè§£æ±ºæ–¹æ¡ˆ 1ï¼šç¦ç”¨æ–‡å­—é¸å–ï¼Œé˜²æ­¢å½ˆå‡º Google æŸ¥è©¢ */
        * {
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        /* æ ¸å¿ƒè§£æ±ºæ–¹æ¡ˆ 2ï¼šç¦æ­¢ä¸‹æ‹‰é‡æ•´ */
        html, body {
            overscroll-behavior-y: contain;
            height: 100%;
            margin: 0; padding: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Roboto, sans-serif;
            overflow: hidden; /* é˜²æ­¢å…¨åŸŸæ»¾å‹•å½±éŸ¿ */
        }

        header {
            background-color: var(--bg);
            padding: 15px;
            text-align: center;
            border-bottom: 2px solid var(--primary);
        }

        header h1 { margin: 0; font-size: 18px; letter-spacing: 2px; color: var(--primary); }

        /* ç¨ç«‹æ»¾å‹•å€åŸŸï¼šè§£æ±ºè¡Œç¨‹æ¶ˆå¤±èˆ‡å…§å®¹é¡¯ç¤ºå•é¡Œ */
        .content-container {
            height: calc(100% - 130px);
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .page { display: none; padding: 20px; animation: fadeIn 0.2s ease; }
        .active { display: block; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }

        /* è‡ªè¨‚è¡Œç¨‹è¼¸å…¥æ¡† */
        .my-schedule-input {
            width: 100%;
            padding: 12px;
            background: #222;
            border: 1px solid #444;
            color: white;
            border-radius: 8px;
            box-sizing: border-box;
            margin-bottom: 10px;
        }

        .btn-add {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            width: 100%;
        }

        .user-item {
            background: #222;
            padding: 10px;
            border-radius: 8px;
            margin-top: 8px;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .nav-bar {
            position: fixed; bottom: 0; width: 100%;
            background: rgba(10, 10, 10, 0.95);
            display: flex; justify-content: space-around;
            padding: 12px 0 25px 0; border-top: 1px solid #333;
            backdrop-filter: blur(10px);
        }

        .nav-item { color: var(--text-s); text-align: center; font-size: 11px; flex: 1; }
        .nav-item.active-nav { color: var(--primary); font-weight: bold; }
        .nav-icon { font-size: 18px; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

<header><h1>SHANGHAI GP 2026</h1></header>

<div class="content-container">
    <div id="home" class="page active">
        <div class="card" style="border-left-color: var(--accent);">
            <h3 id="temp">ğŸŒ¡ï¸ --Â°C</h3>
            <p id="weather-desc">è®€å–æ°£è±¡è³‡æ–™ä¸­...</p>
            <p id="tire-tip" style="color: #00ff00; font-weight: bold; font-size: 12px;"></p>
        </div>
        <div class="card">
            <h3>ğŸ è·é›¢æ­£è³½èµ·è·‘</h3>
            <h2 id="countdown">è¨ˆç®—ä¸­...</h2>
        </div>
    </div>

    <div id="schedule" class="page">
        <div class="card">
            <h3 style="color: gold;">â­ æˆ‘çš„å°ˆå±¬è¡Œç¨‹</h3>
            <input type="text" id="scheduleInput" class="my-schedule-input" placeholder="ä¾‹ï¼š14:00 Kçœ‹å°é›†åˆ...">
            <button class="btn-add" onclick="addUserSchedule()">æ–°å¢è¡Œç¨‹</button>
            <div id="userList"></div>
        </div>
        <div class="card">
            <h3>å®˜æ–¹è³½ç¨‹æ™‚ç¨‹</h3>
            <p>04/17 | 15:30 Sprint Shootout</p>
            <p>04/18 | 11:00 Sprint Race</p>
            <p>04/19 | 15:00 Grand Prix</p>
        </div>
    </div>

    <div id="map" class="page">
        <div class="card">
            <h3>ğŸ“ K çœ‹å° (T14 é«®å¤¾å½)</h3>
            <p>æœ€ä½³è¶…è»Šé»ï¼Œéœ€å¾åœ°éµ 3 è™Ÿå£æ­¥è¡Œ 20 åˆ†é˜ã€‚</p>
        </div>
        
    </div>

    <div id="settings" class="page">
        <div class="card">
            <h3>âš™ï¸ App è³‡è¨Š</h3>
            <p>å·²åœç”¨ç³»çµ±é¸å–èˆ‡æ‰‹å‹¢é‡æ•´</p>
            <p>ç‰ˆæœ¬ï¼šv3.5 Professional</p>
        </div>
    </div>
</div>

<nav class="nav-bar">
    <div class="nav-item active-nav" onclick="showPage('home')" id="nav-home">
        <span class="nav-icon">ğŸ </span>é¦–é 
    </div>
    <div class="nav-item" onclick="showPage('schedule')" id="nav-schedule">
        <span class="nav-icon">ğŸ“…</span>è¡Œç¨‹
    </div>
    <div class="nav-item" onclick="showPage('map')" id="nav-map">
        <span class="nav-icon">ğŸ—ºï¸</span>è³½é“
    </div>
    <div class="nav-item" onclick="showPage('settings')" id="nav-settings">
        <span class="nav-icon">âš™ï¸</span>è¨­å®š
    </div>
</nav>

<script>
    // 1. é é¢åˆ‡æ›ï¼šç¾åœ¨ä¸æœƒå› ç‚ºé¡¯ç¤ºå•é¡Œè®“è¡Œç¨‹æ¶ˆå¤±
    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
        const target = document.getElementById(pageId);
        if (target) target.style.display = 'block';

        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.toggle('active-nav', item.id === 'nav-' + pageId);
        });
    }

    // 2. å¤©æ°£ API ä¸²æ¥
    async function updateWeather() {
        try {
            const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=31.33&longitude=121.22&current_weather=true&hourly=precipitation_probability');
            const data = await res.json();
            document.getElementById('temp').innerText = `ğŸŒ¡ï¸ ${data.current_weather.temperature}Â°C`;
            const prob = data.hourly.precipitation_probability[0];
            document.getElementById('weather-desc').innerText = `ä¸Šæµ·è³½è»Šå ´é™é›¨æ©Ÿç‡ï¼š${prob}%`;
            document.getElementById('tire-tip').innerText = prob > 30 ? "âš ï¸ å»ºè­°æº–å‚™é›¨å…·èˆ‡é›¨èƒ" : "ğŸŸ¢ è³½é“ä¹¾ç‡¥ï¼Œé©åˆä¹¾åœ°èƒ";
        } catch (e) {
            document.getElementById('temp').innerText = "å¤©æ°£è¼‰å…¥å¤±æ•—";
        }
    }

    // 3. å€’æ•¸è¨ˆæ™‚
    function updateCountdown() {
        const raceDate = new Date('2026-04-19T15:00:00').getTime();
        const diff = raceDate - new Date().getTime();
        const d = Math.floor(diff / 86400000);
        const h = Math.floor((diff % 86400000) / 3600000);
        document.getElementById('countdown').innerText = `${d}å¤© ${h}å°æ™‚`;
    }

    // 4. è¡Œç¨‹äº’å‹•åŠŸèƒ½ï¼šå„²å­˜åœ¨æ‰‹æ©Ÿæœ¬åœ°è¨˜æ†¶é«” (LocalStorage)
    function addUserSchedule() {
        const input = document.getElementById('scheduleInput');
        if (!input.value) return;
        const schedules = JSON.parse(localStorage.getItem('f1_schedules') || '[]');
        schedules.push(input.value);
        localStorage.setItem('f1_schedules', JSON.stringify(schedules));
        input.value = '';
        renderSchedules();
    }

    function renderSchedules() {
        const list = document.getElementById('userList');
        const schedules = JSON.parse(localStorage.getItem('f1_schedules') || '[]');
        list.innerHTML = schedules.map((s, i) => `
            <div class="user-item">
                <span>${s}</span>
                <span onclick="deleteSchedule(${i})" style="color:red">âœ•</span>
            </div>
        `).join('');
    }

    function deleteSchedule(index) {
        const schedules = JSON.parse(localStorage.getItem('f1_schedules') || '[]');
        schedules.splice(index, 1);
        localStorage.setItem('f1_schedules', JSON.stringify(schedules));
        renderSchedules();
    }

    // 5. åˆå§‹åŒ–
    window.addEventListener('load', () => {
        updateWeather();
        updateCountdown();
        renderSchedules();
        showPage('home');
        // å®šæ™‚è‡ªå‹•æ›´æ–°å¤©æ°£ (æ¯ 30 åˆ†é˜)ï¼Œç„¡éœ€æ‰‹å‹•é‡æ•´
        setInterval(updateWeather, 1800000);
    });
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>F1 Shanghai 2026</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff1e00">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        :root {
            --primary: #ff1e00;
            --bg: #050505;
            --card: #151515;
            --text: #ffffff;
            --text-s: #888888;
            --accent: #00d2ff;
        }

        body {
            margin: 0; padding: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Roboto, sans-serif;
            overflow-x: hidden;
        }

        header {
            background-color: var(--bg);
            padding: 15px;
            text-align: center;
            border-bottom: 2px solid var(--primary);
            position: sticky; top: 0; z-index: 100;
        }

        header h1 { margin: 0; font-size: 18px; letter-spacing: 2px; color: var(--primary); }

        .page { display: none; padding: 20px; padding-bottom: 100px; animation: fadeIn 0.3s ease; }
        .active { display: block; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary);
        }

        .weather-card { border-left-color: var(--accent); background: linear-gradient(145deg, #151515, #0a1a20); }

        .nav-bar {
            position: fixed; bottom: 0; width: 100%;
            background: rgba(10, 10, 10, 0.95);
            display: flex; justify-content: space-around;
            padding: 12px 0; border-top: 1px solid #333;
            backdrop-filter: blur(10px);
        }

        .nav-item {
            color: var(--text-s); text-decoration: none;
            font-size: 11px; text-align: center; cursor: pointer;
        }

        .nav-item.active-nav { color: var(--primary); font-weight: bold; }
        .nav-icon { font-size: 18px; display: block; margin-bottom: 4px; }

        .badge {
            display: inline-block; padding: 2px 8px; border-radius: 4px;
            font-size: 10px; font-weight: bold; margin-bottom: 8px;
        }
    </style>
</head>
<body>

<header><h1>SHANGHAI GP 2026</h1></header>

<div id="home" class="page active">
    <div class="card weather-card">
        <div class="badge" style="background: var(--accent); color: #000;">LIVE WEATHER</div>
        <h3 id="temp">è¼‰å…¥æ°£æº«ä¸­...</h3>
        <p id="weather-desc">æ­£åœ¨è®€å–ä¸Šæµ·è³½è»Šå ´æ°£è±¡è³‡æ–™...</p>
        <p id="tire-tip" style="color: #00ff00; font-weight: bold;"></p>
    </div>

    <div class="card">
        <div class="badge" style="background: var(--primary); color: white;">COUNTDOWN</div>
        <h3>ğŸ è·é›¢æ­£è³½èµ·è·‘</h3>
        <h2 id="countdown">è¨ˆç®—ä¸­...</h2>
    </div>
</div>

<div id="schedule" class="page">
    <div class="card">
        <div class="badge" style="background: #fff; color: #000;">APRIL 17 FRI</div>
        <h3>è¡åˆºæ’ä½è³½æ—¥</h3>
        <p>11:30 | FP1 è‡ªç”±ç·´ç¿’</p>
        <p>15:30 | Sprint Shootout</p>
    </div>
    <div class="card">
        <div class="badge" style="background: #fff; color: #000;">APRIL 18 SAT</div>
        <h3>è¡åˆºè³½èˆ‡å¤§è³½æ’ä½</h3>
        <p>11:00 | Sprint Race</p>
        <p>15:00 | Qualifying</p>
    </div>
    <div class="card">
        <div class="badge" style="background: var(--primary); color: #fff;">APRIL 19 SUN</div>
        <h3>æ­£è³½ Grand Prix</h3>
        <p>15:00 | Race (56 Laps)</p>
    </div>
</div>

<div id="map" class="page">
    <div class="card">
        <div class="badge" style="background: gold; color: #000;">K STAND GUIDE</div>
        <h3>ğŸ“ K çœ‹å° (T14 é«®å¤¾å½)</h3>
        <p>æ­¤è™•ç‚ºè³½é“æœ€å¼·ç…è»Šé»ï¼Œæ™‚é€Ÿç”± 320 é™è‡³ 80 km/hã€‚</p>
        <p>ğŸš‡ å‡ºå£ï¼šä¸Šæµ·è³½è»Šå ´ç«™ 3 è™Ÿå£ï¼Œæ²¿ä¼Šå¯§è·¯æ­¥è¡Œã€‚</p>
    </div>
    
</div>

<div id="settings" class="page">
    <div class="card">
        <h3>âš™ï¸ App è³‡è¨Š</h3>
        <p>è‡ªå‹•æ›´æ–°ï¼šå·²é–‹å•Ÿ</p>
        <p>å¤©æ°£æ•¸æ“šæºï¼šOpen-Meteo</p>
        <p>ç‰ˆæœ¬ï¼šv3.0 Final Stable</p>
    </div>
</div>

<nav class="nav-bar">
    <div class="nav-item active-nav" onclick="showPage('home')" id="nav-home">
        <span class="nav-icon">ğŸ </span>é¦–é 
    </div>
    <div class="nav-item" onclick="showPage('schedule')" id="nav-schedule">
        <span class="nav-icon">ğŸ“…</span>è³½ç¨‹
    </div>
    <div class="nav-item" onclick="showPage('map')" id="nav-map">
        <span class="nav-icon">ğŸ—ºï¸</span>è³½é“
    </div>
    <div class="nav-item" onclick="showPage('settings')" id="nav-settings">
        <span class="nav-icon">âš™ï¸</span>è¨­å®š
    </div>
</nav>

<script>
    // 1. é é¢åˆ‡æ›
    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
        const target = document.getElementById(pageId);
        if (target) target.style.display = 'block';

        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active-nav');
            if (item.id === 'nav-' + pageId) item.classList.add('active-nav');
        });
    }

    // 2. ç²å–å³æ™‚å¤©æ°£ (ä¸Šæµ·è³½è»Šå ´åº§æ¨™: 31.33, 121.22)
    async function updateWeather() {
        try {
            const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=31.33&longitude=121.22&current_weather=true&hourly=precipitation_probability');
            const data = await res.json();
            const temp = data.current_weather.temperature;
            const rainProb = data.hourly.precipitation_probability[0];

            document.getElementById('temp').innerText = `${temp}Â°C`;
            document.getElementById('weather-desc').innerText = `ç›®å‰é™é›¨æ©Ÿç‡ï¼š${rainProb}%`;

            let tire = "å»ºè­°ä½¿ç”¨ï¼šğŸ”´ è»Ÿèƒ/ä¹¾åœ°èƒ";
            if(rainProb > 30 && rainProb < 60) tire = "å»ºè­°é å‚™ï¼šğŸŸ¢ åŠé›¨èƒ (Intermediate)";
            if(rainProb >= 60) tire = "å»ºè­°ä½¿ç”¨ï¼šğŸ”µ å…¨é›¨èƒ (Wet)";
            document.getElementById('tire-tip').innerText = tire;
        } catch (e) {
            document.getElementById('temp').innerText = "æš«æ™‚ç„¡æ³•ç²å–";
        }
    }

    // 3. å€’æ•¸è¨ˆæ™‚
    function updateCountdown() {
        const raceDate = new Date('2026-04-19T15:00:00').getTime();
        const now = new Date().getTime();
        const diff = raceDate - now;
        const d = Math.floor(diff / (1000 * 60 * 60 * 24));
        const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        document.getElementById('countdown').innerText = `${d}å¤© ${h}å°æ™‚`;
    }

    // 4. åˆå§‹åŒ–
    window.addEventListener('load', () => {
        updateWeather();
        updateCountdown();
        setInterval(updateCountdown, 60000);
        
        // æ¸…é™¤èˆŠ Service Worker é¿å…å¿«å–å•é¡Œ
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.getRegistrations().then(regs => {
                for(let reg of regs) reg.unregister();
            });
        }
    });
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>F1 SHANGHAI K-STAND</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#050505">
    <link rel="manifest" href="manifest.json">
    
    <style>
        :root {
            --bg: #050505; --surface: #121212;
            --primary: #ff1e00; --text-p: #ffffff; --text-s: #8e8e93;
            --k-color: #00d2ff;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Inter', sans-serif; overflow: hidden; height: 100dvh; display: flex; flex-direction: column; }

        header { padding: 55px 20px 15px; background: linear-gradient(to bottom, #350505, var(--bg)); flex-shrink: 0; display: flex; justify-content: space-between; align-items: flex-end; }
        header h1 { margin: 0; font-size: 24px; font-weight: 900; font-style: italic; }
        header h1 span { color: var(--primary); }
        .weather-chip { background: rgba(255,255,255,0.1); padding: 5px 12px; border-radius: 20px; font-size: 12px; display: flex; align-items: center; gap: 5px; border: 1px solid rgba(255,255,255,0.1); }

        .page-container { flex: 1; position: relative; overflow: hidden; }
        .main-page { position: absolute; width: 100%; height: 100%; display: none; flex-direction: column; animation: fadeIn 0.3s ease; }
        .main-page.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .day-nav { display: flex; gap: 10px; padding: 10px 20px; overflow-x: auto; scrollbar-width: none; flex-shrink: 0; }
        .day-tab { flex: 0 0 auto; padding: 10px 18px; border-radius: 12px; background: var(--surface); color: var(--text-s); font-size: 13px; font-weight: 700; }
        .day-tab.active { background: var(--primary); color: white; }

        .scroll-content { flex: 1; overflow-y: auto; padding: 10px 20px 120px; }

        .info-card { background: var(--surface); padding: 18px; border-radius: 20px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.03); }
        .tag { display: inline-block; padding: 3px 8px; border-radius: 5px; font-size: 10px; font-weight: 800; margin-right: 5px; margin-bottom: 5px; }
        .tag-sprint { background: #673ab7; color: white; }
        .tag-k { background: var(--k-color); color: black; }

        .bottom-nav { background: rgba(18, 18, 18, 0.95); backdrop-filter: blur(20px); border-top: 1px solid #222; display: flex; padding: 10px 0 env(safe-area-inset-bottom, 20px); position: fixed; bottom: 0; width: 100%; }
        .nav-btn { background: none; border: none; color: var(--text-s); flex: 1; display: flex; flex-direction: column; align-items: center; font-size: 10px; font-weight: 600; gap: 5px; }
        .nav-btn.active { color: var(--primary); }

        /* Detail Sheet */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; z-index: 1500; }
        #detail-sheet { position: fixed; bottom: -100%; left: 0; width: 100%; height: 80%; background: #1c1c1e; border-radius: 30px 30px 0 0; z-index: 2000; transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1); padding: 40px 25px; overflow-y: auto; }
        #detail-sheet.open { bottom: 0; }
        .sheet-handle { width: 40px; height: 5px; background: #333; border-radius: 3px; position: absolute; top: 15px; left: 50%; transform: translateX(-50%); }
    </style>
</head>
<body>

    <header>
        <h1>SHANGHAI <span>GP</span></h1>
        <div class="weather-chip" onclick="window.open('https://www.windy.com/31.339/121.222?31.320,121.222,13', '_blank')">
            <span>ğŸŒ¦ï¸</span> <span id="temp-val">é å ±ä¸­å¿ƒ</span>
        </div>
    </header>

    <div class="page-container">
        <div id="page-schedule" class="main-page active">
            <div class="day-nav" id="day-nav"></div>
            <div class="scroll-content" id="schedule-list"></div>
        </div>

        <div id="page-track" class="main-page">
            <div class="scroll-content">
                <div class="info-card" style="border-left: 5px solid var(--k-color);">
                    <div class="card-body">
                        <span class="tag tag-k">K çœ‹å°å°ˆå±¬</span>
                        <h3>14 è™Ÿå½è¶…è»Šé»</h3>
                        <p>K çœ‹å°ä½æ–¼é•·ç›´é“æœ«ç«¯çš„é«®å¤¾å½ï¼Œæ˜¯å…¨è³½é“æœ€å¼·ç…è»Šé»ï¼Œä¹Ÿæ˜¯è¶…è»Šç•«é¢æœ€å¤šçš„å€åŸŸã€‚</p>
                    </div>
                </div>
                <div class="info-card">
                    <div class="card-body">
                        <h3>å¦‚ä½•åˆ°é” K çœ‹å°ï¼Ÿ</h3>
                        <p>å¾åœ°éµç«™å‡ºç™¼å¾Œï¼ŒK çœ‹å°ä½æ–¼è³½å ´æ±å´ï¼Œæ­¥è¡Œè·é›¢ç´„ 15-20 åˆ†é˜ã€‚å»ºè­°ç”± 1 è™Ÿæˆ– 2 è™Ÿå…¥å£é€²å ´ã€‚</p>
                    </div>
                </div>
                <div class="info-card">
                    <div class="card-body">
                        <span class="tag">ğŸ”­ å»ºè­°</span>
                        <h3>æœ›é é¡èˆ‡æ‹æ”</h3>
                        <p>K çœ‹å°ä½ç½®è¼ƒé«˜ï¼Œå¯ä¿¯ç°æ•´å€‹é•·ç›´é“ï¼Œå»ºè­°æ”œå¸¶æœ›é é¡è§€å¯Ÿ DRS é–‹å•Ÿç¬é–“ã€‚</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-pay" class="main-page">
            <div class="scroll-content">
                <h2>æ”¯ä»˜èˆ‡é€šè¨Š</h2>
                <div class="info-card">
                    <div class="card-body">
                        <h3>æ”¯ä»˜å¯¶ / å¾®ä¿¡å¯¦å</h3>
                        <p>ç¾å ´æ”¤ä½ä¸æ”¶ç¾é‡‘ï¼Œè«‹ç¢ºèªå·²å®Œæˆã€Œè­‰ä»¶ä¸Šå‚³ã€å¯¦åèªè­‰ï¼Œå¦å‰‡ç„¡æ³•æ”¯ä»˜è¶…é 200 å…ƒçš„é‡‘é¡ã€‚</p>
                    </div>
                </div>
                <div class="info-card">
                    <div class="card-body">
                        <h3>è³½å ´ç¶²è·¯ (eSIM)</h3>
                        <p>æ•¸è¬äººèšé›†æœƒå°è‡´ 5G å¡è»Šï¼Œå»ºè­°ä¸‹è¼‰é›¢ç·šåœ°åœ–ï¼Œä¸¦å°‡å°èƒè­‰è³‡è¨Šæˆªåœ–å‚™ä»½ã€‚</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-settings" class="main-page">
            <div class="scroll-content">
                <h2>è¨­å®š</h2>
                <div class="info-card" onclick="location.reload()">
                    <div class="card-body"><h3>æª¢æŸ¥ App æ›´æ–°</h3><p>æŠ“å–æœ€æ–°è³½ç¨‹èˆ‡å¤©æ°£é€£çµ</p></div>
                </div>
                <div class="info-card" onclick="toggleHaptic()">
                    <div class="card-body" style="display:flex; justify-content:space-between; align-items:center;">
                        <div><h3>è§¸è¦ºå›é¥‹</h3><p id="haptic-status">ç‹€æ…‹ï¼šé–‹å•Ÿ</p></div>
                        <input type="checkbox" checked id="haptic-toggle">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <button class="nav-btn active" onclick="nav('schedule', this)"><span>ğŸ—“ï¸</span>è³½ç¨‹</button>
        <button class="nav-btn" onclick="nav('track', this)"><span>ğŸ”­</span>Kçœ‹å°</button>
        <button class="nav-btn" onclick="nav('pay', this)"><span>ğŸ’³</span>æ”¯ä»˜</button>
        <button class="nav-btn" onclick="nav('settings', this)"><span>âš™ï¸</span>è¨­å®š</button>
    </nav>

    <div class="overlay" onclick="closeSheet()"></div>
    <div id="detail-sheet">
        <div class="sheet-handle"></div>
        <div id="sheet-content"></div>
        <button onclick="closeSheet()" style="width:100%; padding:18px; border-radius:16px; border:none; background:#2c2c2e; color:white; font-weight:bold; margin-top:20px">æ”¶èµ·è©³æƒ…</button>
    </div>

    <script>
        // å¼·åˆ¶æ¸…é™¤èˆŠæœ‰çš„ PWA å¿«å–èˆ‡è¨»å†Šè³‡è¨Š
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then(function(registrations) {
        for(let registration of registrations) {
            registration.unregister();
        }
    });
}

        let isHapticOn = true;
        // è¡åˆºè³½é€±æœ«è³½ç¨‹é‚è¼¯
        const scheduleData = {
            d1: [{ time: '13:00', title: 'æŠµé”ä¸Šæµ·', icon: 'ğŸ‡¨ğŸ‡³', detail: 'å»ºè­°é£¯åº—ï¼šéœå®‰æˆ–å˜‰å®šå€ã€‚', tags: ['å°èƒè­‰'] }],
            d2: [
                { time: '11:30', title: 'è‡ªç”±ç·´ç¿’ FP1', icon: 'ğŸï¸', detail: 'è¡åˆºè³½é€±æœ«å”¯ä¸€ä¸€ç¯€ç·´ç¿’ï¼Œè»ŠéšŠæœƒé€²è¡Œå¯†é›†çš„è¨­å®šæ¸¬è©¦ã€‚', tags: ['ç·´ç¿’è³½'] },
                { time: '15:30', title: 'è¡åˆºæ’ä½è³½ Sprint Shootout', icon: 'â±ï¸', detail: 'æ±ºå®šé€±å…­è¡åˆºè³½çš„èµ·è·‘é †ä½ã€‚è¦å‰‡æ›´åš´æ ¼ï¼Œä½¿ç”¨è¼ªèƒå¼·åˆ¶è¦å®šã€‚', tags: ['è¡åˆºè³½'] }
            ],
            d3: [
                { time: '11:00', title: 'è¡åˆºè³½ Sprint Race', icon: 'ğŸ', detail: '100å…¬é‡Œçš„çŸ­ç¨‹è¡åˆºï¼Œå‰å…«åæœ‰ç©åˆ†ã€‚ä¸éœ€å¼·åˆ¶é€²ç«™ã€‚', tags: ['è¡åˆºè³½', 'ç©åˆ†'] },
                { time: '15:00', title: 'æ’ä½è³½ Qualifying', icon: 'â±ï¸', detail: 'æ±ºå®šé€±æ—¥æ­£è³½èµ·è·‘é †ä½ã€‚K çœ‹å°çœ‹æ’ä½è³½éå¸¸éç™®ï¼Œå¯ä»¥çœ‹åˆ°è»Šæ‰‹æ¨å‘æ¥µé™ã€‚', tags: ['æ­£è³½æ’ä½'] }
            ],
            d4: [
                { time: '15:00', title: 'ä¸Šæµ·ç«™æ­£è³½ Race', icon: 'ğŸ†', detail: '56 åœˆæ­£è³½ã€‚14 è™Ÿå½ï¼ˆKçœ‹å°å‰ï¼‰æ˜¯ DRS è¶…è»Šå€çµ‚é»ï¼Œçµ•å°æ˜¯æ±ºæˆ°åœ°ã€‚', tags: ['æ­£è³½'] }
            ],
            d5: [{ time: '11:00', title: 'å¤–ç˜éŠè¦½ / è¿”ç¨‹', icon: 'ğŸ›«', detail: 'æº–å‚™å‰å¾€æ©Ÿå ´ã€‚', tags: ['æ”¯ä»˜å¯¶'] }]
        };

        function haptic(ms) { if (isHapticOn && navigator.vibrate) navigator.vibrate(ms); }
        function toggleHaptic() {
            isHapticOn = !isHapticOn;
            document.getElementById('haptic-toggle').checked = isHapticOn;
            document.getElementById('haptic-status').innerText = `ç‹€æ…‹ï¼š${isHapticOn ? 'é–‹å•Ÿ' : 'å·²é—œé–‰'}`;
            if(isHapticOn) haptic(30);
        }

        function nav(id, btn) {
            haptic(15);
            document.querySelectorAll('.main-page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + id).classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function renderDayNav() {
            const days = { d1: '12 Thu', d2: '13 Fri', d3: '14 Sat', d4: '15 Sun', d5: '16 Mon' };
            document.getElementById('day-nav').innerHTML = Object.entries(days).map(([key, label]) => 
                `<div class="day-tab ${key === 'd1' ? 'active' : ''}" onclick="switchDay('${key}', this)">${label}</div>`
            ).join('');
        }

        function switchDay(dayId, btn) {
            haptic(10);
            document.querySelectorAll('.day-tab').forEach(t => t.classList.remove('active'));
            btn.classList.add('active');
            renderEvents(dayId);
        }

        function renderEvents(day) {
            const list = document.getElementById('schedule-list');
            const events = scheduleData[day] || [];
            list.innerHTML = events.map(e => `
                <div class="info-card" onclick="openSheet('${e.title}', '${e.detail}', '${e.tags}')">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <span style="font-size:11px; font-weight:800; color:var(--primary)">${e.time}</span>
                            <h3 style="margin:5px 0">${e.icon} ${e.title}</h3>
                            <div style="display:flex">${e.tags.map(t => `<span class="tag ${t.includes('è¡åˆº')?'tag-sprint':''}">${t}</span>`).join('')}</div>
                        </div>
                        <div style="color:#333">â¯</div>
                    </div>
                </div>
            `).join('');
        }

        function openSheet(title, detail, tags) {
            haptic(20);
            document.getElementById('sheet-content').innerHTML = `
                <h2 style="margin-bottom:20px">${title}</h2>
                <div style="line-height:1.8; color:#ccc; font-size:16px">${detail}</div>
            `;
            document.getElementById('detail-sheet').classList.add('open');
            document.querySelector('.overlay').style.display = 'block';
        }

        function closeSheet() {
            document.getElementById('detail-sheet').classList.remove('open');
            document.querySelector('.overlay').style.display = 'none';
        }

        window.onload = () => { renderDayNav(); renderEvents('d1'); };
    </script>
</body>
</html>

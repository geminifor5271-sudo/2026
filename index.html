<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>F1 SHANGHAI K-STAND</title>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#050505">
    <link rel="manifest" href="manifest.json">
    
    <style>
        :root {
            --bg: #050505; --surface: #121212;
            --primary: #ff1e00; --text-p: #ffffff; --text-s: #8e8e93;
            --k-color: #00d2ff;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Inter', sans-serif; overflow: hidden; height: 100dvh; display: flex; flex-direction: column; }

        header { padding: 55px 20px 15px; background: linear-gradient(to bottom, #350505, var(--bg)); flex-shrink: 0; display: flex; justify-content: space-between; align-items: flex-end; }
        header h1 { margin: 0; font-size: 24px; font-weight: 900; font-style: italic; }
        header h1 span { color: var(--primary); }
        .weather-chip { background: rgba(255,255,255,0.1); padding: 5px 12px; border-radius: 20px; font-size: 12px; display: flex; align-items: center; gap: 5px; border: 1px solid rgba(255,255,255,0.1); }

        .page-container { flex: 1; position: relative; overflow: hidden; }
        .main-page { position: absolute; width: 100%; height: 100%; display: none; flex-direction: column; animation: fadeIn 0.3s ease; }
        .main-page.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .day-nav { display: flex; gap: 10px; padding: 10px 20px; overflow-x: auto; scrollbar-width: none; flex-shrink: 0; }
        .day-tab { flex: 0 0 auto; padding: 10px 18px; border-radius: 12px; background: var(--surface); color: var(--text-s); font-size: 13px; font-weight: 700; }
        .day-tab.active { background: var(--primary); color: white; }

        .scroll-content { flex: 1; overflow-y: auto; padding: 10px 20px 120px; }

        .info-card { background: var(--surface); padding: 18px; border-radius: 20px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.03); }
        .tag { display: inline-block; padding: 3px 8px; border-radius: 5px; font-size: 10px; font-weight: 800; margin-right: 5px; margin-bottom: 5px; }
        .tag-sprint { background: #673ab7; color: white; }
        .tag-k { background: var(--k-color); color: black; }

        .bottom-nav { background: rgba(18, 18, 18, 0.95); backdrop-filter: blur(20px); border-top: 1px solid #222; display: flex; padding: 10px 0 env(safe-area-inset-bottom, 20px); position: fixed; bottom: 0; width: 100%; }
        .nav-btn { background: none; border: none; color: var(--text-s); flex: 1; display: flex; flex-direction: column; align-items: center; font-size: 10px; font-weight: 600; gap: 5px; }
        .nav-btn.active { color: var(--primary); }

        /* Detail Sheet */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); display: none; z-index: 1500; }
        #detail-sheet { position: fixed; bottom: -100%; left: 0; width: 100%; height: 80%; background: #1c1c1e; border-radius: 30px 30px 0 0; z-index: 2000; transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1); padding: 40px 25px; overflow-y: auto; }
        #detail-sheet.open { bottom: 0; }
        .sheet-handle { width: 40px; height: 5px; background: #333; border-radius: 3px; position: absolute; top: 15px; left: 50%; transform: translateX(-50%); }
    </style>
</head>
<body>

    <header>
        <h1>SHANGHAI <span>GP</span></h1>
        <div class="weather-chip" onclick="window.open('https://www.windy.com/31.339/121.222?31.320,121.222,13', '_blank')">
            <span>ğŸŒ¦ï¸</span> <span id="temp-val">é å ±ä¸­å¿ƒ</span>
        </div>
    </header>

    <div class="page-container">
        <div id="page-schedule" class="main-page active">
            <div class="day-nav" id="day-nav"></div>
            <div class="scroll-content" id="schedule-list"></div>
        </div>

        <div id="page-track" class="main-page">
            <div class="scroll-content">
                <div class="info-card" style="border-left: 5px solid var(--k-color);">
                    <div class="card-body">
                        <span class="tag tag-k">K çœ‹å°å°ˆå±¬</span>
                        <h3>14 è™Ÿå½è¶…è»Šé»</h3>
                        <p>K çœ‹å°ä½æ–¼é•·ç›´é“æœ«ç«¯çš„é«®å¤¾å½ï¼Œæ˜¯å…¨è³½é“æœ€å¼·ç…è»Šé»ï¼Œä¹Ÿæ˜¯è¶…è»Šç•«é¢æœ€å¤šçš„å€åŸŸã€‚</p>
                    </div>
                </div>
                <div class="info-card">
                    <div class="card-body">
                        <h3>å¦‚ä½•åˆ°é” K çœ‹å°ï¼Ÿ</h3>
                        <p>å¾åœ°éµç«™å‡ºç™¼å¾Œï¼ŒK çœ‹å°ä½æ–¼è³½å ´æ±å´ï¼Œæ­¥è¡Œè·é›¢ç´„ 15-20 åˆ†é˜ã€‚å»ºè­°ç”± 1 è™Ÿæˆ– 2 è™Ÿå…¥å£é€²å ´ã€‚</p>
                    </div>
                </div>
                <div class="info-card">
                    <div class="card-body">
                        <span class="tag">ğŸ”­ å»ºè­°</span>
                        <h3>æœ›é é¡èˆ‡æ‹æ”</h3>
                        <p>K çœ‹å°ä½ç½®è¼ƒé«˜ï¼Œå¯ä¿¯ç°æ•´å€‹é•·ç›´é“ï¼Œå»ºè­°æ”œå¸¶æœ›é é¡è§€å¯Ÿ DRS é–‹å•Ÿç¬é–“ã€‚</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-pay" class="main-page">
            <div class="scroll-content">
                <h2>æ”¯ä»˜èˆ‡é€šè¨Š</h2>
                <div class="info-card">
                    <div class="card-body">
                        <h3>æ”¯ä»˜å¯¶ / å¾®ä¿¡å¯¦å</h3>
                        <p>ç¾å ´æ”¤ä½ä¸æ”¶ç¾é‡‘ï¼Œè«‹ç¢ºèªå·²å®Œæˆã€Œè­‰ä»¶ä¸Šå‚³ã€å¯¦åèªè­‰ï¼Œå¦å‰‡ç„¡æ³•æ”¯ä»˜è¶…é 200 å…ƒçš„é‡‘é¡ã€‚</p>
                    </div>
                </div>
                <div class="info-card">
                    <div class="card-body">
                        <h3>è³½å ´ç¶²è·¯ (eSIM)</h3>
                        <p>æ•¸è¬äººèšé›†æœƒå°è‡´ 5G å¡è»Šï¼Œå»ºè­°ä¸‹è¼‰é›¢ç·šåœ°åœ–ï¼Œä¸¦å°‡å°èƒè­‰è³‡è¨Šæˆªåœ–å‚™ä»½ã€‚</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-settings" class="main-page">
            <div class="scroll-content">
                <h2>è¨­å®š</h2>
                <div class="info-card" onclick="location.reload()">
                    <div class="card-body"><h3>æª¢æŸ¥ App æ›´æ–°</h3><p>æŠ“å–æœ€æ–°è³½ç¨‹èˆ‡å¤©æ°£é€£çµ</p></div>
                </div>
                <div class="info-card" onclick="toggleHaptic()">
                    <div class="card-body" style="display:flex; justify-content:space-between; align-items:center;">
                        <div><h3>è§¸è¦ºå›é¥‹</h3><p id="haptic-status">ç‹€æ…‹ï¼šé–‹å•Ÿ</p></div>
                        <input type="checkbox" checked id="haptic-toggle">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <nav class="bottom-nav">
        <button class="nav-btn active" onclick="nav('schedule', this)"><span>ğŸ—“ï¸</span>è³½ç¨‹</button>
        <button class="nav-btn" onclick="nav('track', this)"><span>ğŸ”­</span>Kçœ‹å°</button>
        <button class="nav-btn" onclick="nav('pay', this)"><span>ğŸ’³</span>æ”¯ä»˜</button>
        <button class="nav-btn" onclick="nav('settings', this)"><span>âš™ï¸</span>è¨­å®š</button>
    </nav>

    <div class="overlay" onclick="closeSheet()"></div>
    <div id="detail-sheet">
        <div class="sheet-handle"></div>
        <div id="sheet-content"></div>
        <button onclick="closeSheet()" style="width:100%; padding:18px; border-radius:16px; border:none; background:#2c2c2e; color:white; font-weight:bold; margin-top:20px">æ”¶èµ·è©³æƒ…</button>
    </div>

    <script>
// 1. å¼·åˆ¶è¨»éŠ·èˆŠçš„ Service Worker (ç¢ºä¿ App ä¿æŒæœ€æ–°ç‹€æ…‹)
if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then(registrations => {
        for(let reg of registrations) reg.unregister();
    });
}

// 2. è¨­å®šè®Šæ•¸
let isHapticOn = true;

// 3. æ¨¡æ“¬ F1 æ©Ÿæ¢°éœ‡å‹•æ„Ÿçš„å‡½æ•¸ (å°ˆç‚º S24 Ultra å„ªåŒ–)
function haptic(type) {
    if (!isHapticOn || !navigator.vibrate) return;
    const patterns = {
        'click': 15,          // è¼•å¾®è§¸æ„Ÿ
        'gear': [10, 30, 15], // æ¨¡æ“¬ F1 æ›æª”
        'alert': [60, 100, 60] // å¼·åŠ›æé†’
    };
    navigator.vibrate(patterns[type] || 20);
}

// 4. é é¢åˆ‡æ›åŠŸèƒ½
function showPage(pageId) {
    // åŸ·è¡Œéœ‡å‹•å›é¥‹
    haptic('click');
    
    // éš±è—æ‰€æœ‰é é¢ï¼Œé¡¯ç¤ºé»é¸çš„é é¢
    document.querySelectorAll('.page').forEach(p => p.style.display = 'none');
    const targetPage = document.getElementById(pageId);
    if (targetPage) targetPage.style.display = 'block';

    // æ›´æ–°ä¸‹æ–¹å°èˆªåˆ—æŒ‰éˆ•çš„é¡è‰² (å‡è¨­ä½ çš„æŒ‰éˆ• class æ˜¯ nav-item)
    document.querySelectorAll('.nav-item').forEach(item => {
        item.style.color = (item.getAttribute('onclick').includes(pageId)) ? '#ff1e00' : '#888';
    });
}

// 5. K çœ‹å°è§€è³½å°æ’‡æ­¥ (14 è™Ÿå½å°ˆå±¬)
function loadKTips() {
    const tipBox = document.getElementById('k-stand-tips');
    if (tipBox) {
        tipBox.innerHTML = `
            <div style="background:#1a1a1a; padding:15px; border-radius:10px; border-left:4px solid #ff1e00;">
                <h4 style="margin:0">ğŸï¸ K çœ‹å°ç¾å ´æ”»ç•¥</h4>
                <p style="font-size:14px; color:#ccc;">é€™è£¡æ˜¯ DRS å€çµ‚é»ï¼Œæœ€å®¹æ˜“ç™¼ç”Ÿè¶…è»Šï¼å»ºè­°æ³¨æ„çœ‹ 14 å½çš„å…¥å½é»ã€‚æ­¥è¡Œå»ºè­°ï¼šç”± 11 è™Ÿç·šä¸Šæµ·è³½è»Šå ´ç«™ 3 è™Ÿå£æ­¥è¡Œç´„ 20 åˆ†é˜ã€‚</p>
            </div>
        `;
    }
}

// 6. ç¶²é è¼‰å…¥å¾ŒåŸ·è¡Œçš„å‹•ä½œ
window.onload = () => {
    showPage('home'); // é è¨­é¡¯ç¤ºé¦–é 
    loadKTips();      // è¼‰å…¥ K çœ‹å°æ”»ç•¥
};
</script>
</body>
</html>
